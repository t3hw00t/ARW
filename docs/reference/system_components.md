---
title: System Components
---

<!-- generated by scripts/gen_system_components.py; do not edit by hand (source ts: 2025-10-07T16:38:34+02:00) -->

# System Components

Updated: 2025-10-12
Status: Stable
Type: Reference

Microsummary:
- Component inventory mapped to the feature registry and runtime scopes.
- Generated from interfaces/system_components.json with cross-links into interfaces/features.json.
- Summarizes category, scope, owners, key interfaces, storage, and reference docs per component.
- Refresh with `python3 scripts/gen_system_components.py` (or matching Just recipe) after catalog updates.

This page is generated from [interfaces/system_components.json](https://github.com/t3hw00t/ARW/blob/main/interfaces/system_components.json) and reconciled with [interfaces/features.json](https://github.com/t3hw00t/ARW/blob/main/interfaces/features.json) plus topic constants in [`crates/arw-topics`](https://github.com/t3hw00t/ARW/blob/main/crates/arw-topics/src/lib.rs).

## Component Matrix

| Component | Feature | Category | Scope | Owner | Key Interfaces | References |
| --- | --- | --- | --- | --- | --- | --- |
| Agent Orchestrator | [Orchestrator Plane](feature_matrix.md#orchestrator-plane)<br /><small>Remote collaborator pack</small> | Runtime | Remote collaborator pack / runtime / developers / orchestration / plan | platform | GET /orchestrator/mini_agents<br />POST /orchestrator/mini_agents/start_training<br />POST /orchestrator/runtimes/{id}/restore<br />…<br />task.completed<br />runtime.restore.requested<br />… | [architecture/agent_orchestrator.md](../architecture/agent_orchestrator.md) |
| AppSec Harness | — | Security & Policy | runtime / operators / assurance / plan | platform | — | [architecture/appsec_harness.md](../architecture/appsec_harness.md) |
| Artifacts Provenance & Model CAS | [Model Steward](feature_matrix.md#model-steward)<br /><small>Core kernel</small> | Runtime | Core kernel / runtime / operators / data plane / plan | platform | GET /admin/models/summary<br />POST /admin/models/download<br />POST /admin/models/download/cancel<br />…<br />models.download.progress<br />models.changed<br />… | [architecture/artifacts_provenance.md](../architecture/artifacts_provenance.md) |
| Asimov Capsule Guard | [Asimov Capsule Guard](feature_matrix.md#asimov-capsule-guard)<br /><small>Future pack</small> | Security & Policy | Future pack / runtime / operators / guardrails / alpha | platform | ANY /admin/* (X-ARW-Capsule)<br />policy.decision<br />rpu.trust.changed<br />… | [architecture/asimov_capsule_guard.md](../architecture/asimov_capsule_guard.md) |
| Cache Policy & Action Cache | [Tool Forge](feature_matrix.md#tool-forge)<br /><small>Core kernel</small> | Runtime | Core kernel / runtime / developers / data plane / plan | platform | GET /admin/tools<br />POST /admin/tools/run<br />GET /admin/tools/cache_stats<br />…<br />task.completed | [architecture/cache_policy.md](../architecture/cache_policy.md)<br />[architecture/caching_layers.md](../architecture/caching_layers.md) |
| Capability & Consent Ledger | — | Governance | runtime / operators / governance / plan | platform | — | [architecture/capability_consent_ledger.md](../architecture/capability_consent_ledger.md) |
| Compliance Mode | — | Governance | workspace / operators / governance / plan | platform | — | [architecture/compliance_mode.md](../architecture/compliance_mode.md) |
| Config Plane & Patch Engine | [Config Plane](feature_matrix.md#config-plane)<br /><small>Core kernel</small> | Configuration | Core kernel / admin / operators / configuration / plan | platform | GET /state/config<br />GET /state/config/snapshots<br />GET /state/config/snapshots/:id<br />…<br />config.patch.applied<br />logic.unit.reverted | [architecture/config_patch_engine.md](../architecture/config_patch_engine.md)<br />[configs/schema_map.json](https://github.com/t3hw00t/ARW/blob/main/configs/schema_map.json) |
| Context Working Set | [Working Set Builder](feature_matrix.md#working-set-builder)<br /><small>Core kernel</small> | Runtime | Core kernel / runtime / developers / context / plan | platform | POST /context/assemble<br />POST /context/rehydrate<br />working_set.started<br />working_set.seed<br />… | [architecture/context_working_set.md](../architecture/context_working_set.md) |
| Data Governance & Privacy | — | Governance | workspace / operators / governance / plan | platform | — | [architecture/data_governance.md](../architecture/data_governance.md) |
| Durability & Offline Resilience | — | Runtime | runtime / operators / infrastructure / plan | platform | — | [architecture/durability.md](../architecture/durability.md) |
| Egress Firewall & Ledger | [Egress Sentinel](feature_matrix.md#egress-sentinel)<br /><small>Core kernel</small> | Security & Policy | Core kernel / runtime / operators / guardrails / plan | platform | POST /egress/preview<br />POST /egress/settings<br />GET /state/egress<br />…<br />egress.ledger.appended<br />egress.settings.updated | [architecture/egress_firewall.md](../architecture/egress_firewall.md)<br />[guide/network_posture.md](../guide/network_posture.md) |
| Experiment Orchestrator | — | Runtime | runtime / operators / orchestration / plan | platform | /state/experiments | [architecture/experiment_orchestrator.md](../architecture/experiment_orchestrator.md) |
| Federated Clustering | — | Runtime | runtime / operators / infrastructure / plan | platform | — | [architecture/cluster_federation.md](../architecture/cluster_federation.md) |
| Identity & Tenancy | — | Governance | workspace / operators / governance / beta | platform | — | [architecture/identity_tenancy.md](../architecture/identity_tenancy.md) |
| Lightweight Mitigations | — | Security & Policy | runtime / operators / assurance / plan | platform | — | [architecture/lightweight_mitigations.md](../architecture/lightweight_mitigations.md) |
| Memory Abstraction Layer & Memory Atlas | [Memory Atlas](feature_matrix.md#memory-atlas)<br /><small>Core kernel</small> | Runtime | Core kernel / runtime / developers / data plane / plan | platform | POST /actions (memory.upsert)<br />POST /actions (memory.search)<br />POST /actions (memory.pack)<br />…<br />memory.item.upserted<br />memory.item.expired<br />… | [architecture/memory_abstraction.md](../architecture/memory_abstraction.md)<br />[architecture/memory_lifecycle.md](../architecture/memory_lifecycle.md)<br />[architecture/memory_overlay_service.md](../architecture/memory_overlay_service.md) |
| Policy & Gating Core | [Policy & Lease Facade](feature_matrix.md#policy-lease-facade)<br /><small>Core kernel</small> | Security & Policy | Core kernel / runtime / operators / guardrails / beta | platform | GET /state/policy<br />POST /policy/reload<br />POST /policy/simulate<br />…<br />policy.decision<br />policy.reloaded | [GATING_KEYS.md](../GATING_KEYS.md)<br />[guide/policy_permissions.md](../guide/policy_permissions.md)<br />[crates/arw-core/src/gating.rs](https://github.com/t3hw00t/ARW/blob/main/crates/arw-core/src/gating.rs) |
| Replay & Observability Stack | — | Runtime | runtime / operators / assurance / plan | platform | — | [architecture/replay_time_travel.md](../architecture/replay_time_travel.md)<br />[architecture/observability_otel.md](../architecture/observability_otel.md) |
| Runtime Layout & Control Plane Priority | [Snappy Governor](feature_matrix.md#snappy-governor)<br /><small>Core kernel</small> | Runtime | Core kernel / runtime / developers / infrastructure / beta | platform | GET /metrics<br />GET /state/route_stats<br />snappy.notice<br />snappy.detail<br />… | [architecture/runtime_layout.md](../architecture/runtime_layout.md)<br />[architecture/performance.md](../architecture/performance.md) |
| SSE + JSON Patch Streaming Contract | [Event Spine](feature_matrix.md#event-spine)<br /><small>Core kernel</small> | Runtime | Core kernel / runtime / developers / data plane / beta | platform | GET /events<br />state.read.model.patch | [architecture/sse_patch_contract.md](../architecture/sse_patch_contract.md) |
| Scheduler & Governor | — | Runtime | runtime / operators / infrastructure / plan | platform | — | [architecture/scheduler_governor.md](../architecture/scheduler_governor.md)<br />[architecture/scheduling_backpressure.md](../architecture/scheduling_backpressure.md) |
| Self-Model (Metacognition) | [Self Card + Forecasts](feature_matrix.md#self-card-forecasts)<br /><small>Core kernel</small> | Runtime | Core kernel / runtime / operators / orchestration / plan | platform | GET /state/self<br />GET /state/self/:agent<br />POST /admin/self_model/propose<br />…<br />self.model.proposed<br />self.model.updated | [architecture/self_model.md](../architecture/self_model.md) |
| Supply-Chain Trust | — | Security & Policy | build / operators / assurance / plan | platform | — | [architecture/supply_chain_trust.md](../architecture/supply_chain_trust.md)<br />[developer/ci.md](../developer/ci.md) |
| UI Screenshot Tools | [Screenshot Capture Pipeline](feature_matrix.md#screenshot-capture-pipeline)<br /><small>Opt-in pack</small> | UX | Opt-in pack / runtime / operators / experience / beta | platform | POST /admin/tools/run<br />screenshots.captured<br />ui.screenshot.capture<br />ui.screenshot.annotate_burn<br />… | [architecture/screenshot_capture_pipeline.md](../architecture/screenshot_capture_pipeline.md)<br />[guide/screenshots.md](../guide/screenshots.md) |
| Unified Object Graph & Event Stream | [Project Map (World Model)](feature_matrix.md#project-map-world-model)<br /><small>Core kernel</small> | Runtime | Core kernel / ui / operators / data plane / beta | platform | GET /state/observations<br />GET /state/beliefs<br />GET /state/intents<br />…<br />world.updated | [architecture/object_graph.md](../architecture/object_graph.md) |
| Versioning & Migration Backbone | — | Runtime | runtime / operators / configuration / beta | platform | — | [architecture/versioning_migration.md](../architecture/versioning_migration.md) |

## Component Details

### Agent Orchestrator

Manages mini-agent training episodes, evaluates them via the triad, and promotes configurations into Logic Units under policy guardrails.

- Feature: [Orchestrator Plane](feature_matrix.md#orchestrator-plane) (Remote collaborator pack)
- Category: Runtime
- Scope: Remote collaborator pack / runtime / developers / orchestration / plan
- Owner: platform
- Depends on:
  - Memory Abstraction Layer & Memory Atlas
  - SSE + JSON Patch Streaming Contract
- Signals & Telemetry:
  - `task.completed`
  - `runtime.restore.requested`
  - `runtime.restore.completed`
  - `orchestrator.job.created`
  - `orchestrator.job.progress`
  - `orchestrator.job.completed`
- HTTP:
  - `GET /orchestrator/mini_agents`
  - `POST /orchestrator/mini_agents/start_training`
  - `POST /orchestrator/runtimes/{id}/restore`
  - `GET /state/orchestrator/jobs`
  - `/orchestrator/mini_agents`
  - `/orchestrator/mini_agents/start_training`
  - `/state/orchestrator/jobs`
- Environment:
  - `ARW_NATS_URL`
  - `ARW_NODE_ID`
  - `ARW_NATS_OUT`
- Topics:
  - `task.completed`
  - `runtime.restore.requested`
  - `runtime.restore.completed`
- References:
  - [architecture/agent_orchestrator.md](../architecture/agent_orchestrator.md)
- Notes:
  - Training stays lease-gated and reproducible via corr_id snapshots with budget tracking.
  - Future phases add curriculum learning, self-play, and confidence-aware routing.

### AppSec Harness

Security harness with seeded LLM threat tests, runtime filters, and reporting that surface violations as policy decisions.

- Category: Security & Policy
- Scope: runtime / operators / assurance / plan
- Owner: platform
- Depends on:
  - Policy & Gating Core
  - Asimov Capsule Guard
- Signals & Telemetry:
  - `policy.decision`
- References:
  - [architecture/appsec_harness.md](../architecture/appsec_harness.md)
- Notes:
  - Checklists and seeded prompts exercise prompt-injection, insecure outputs, SSRF, and leakage cases.
  - Runtime guards block before memory or action pipelines and roll results into per-episode reports.

### Artifacts Provenance & Model CAS

Tracks artifacts as typed nodes with provenance edges tying inputs, policies, and tools to outputs while storing models in CAS for deduplicated reuse.

- Feature: [Model Steward](feature_matrix.md#model-steward) (Core kernel)
- Category: Runtime
- Scope: Core kernel / runtime / operators / data plane / plan
- Owner: platform
- Depends on:
  - Versioning & Migration Backbone
  - SSE + JSON Patch Streaming Contract
  - Guardrail Gateway (Policy + Egress)
- Signals & Telemetry:
  - `models.download.progress`
  - `models.changed`
  - `models.manifest.written`
  - `models.cas.gc`
  - `models.refreshed`
  - `state.read.model.patch`
- HTTP:
  - `GET /admin/models/summary`
  - `POST /admin/models/download`
  - `POST /admin/models/download/cancel`
  - `POST /admin/models/cas_gc`
  - `GET /admin/models/concurrency`
  - `POST /admin/models/concurrency`
  - `GET /admin/models/jobs`
  - `GET /state/models_metrics`
  - `GET /state/models_hashes`
  - `GET /state/models`
- Environment:
  - `ARW_MODELS_MAX_MB`
  - `ARW_MODELS_DISK_RESERVE_MB`
  - `ARW_MODELS_MAX_CONC`
  - `ARW_MODELS_MAX_CONC_HARD`
  - `ARW_MODELS_QUOTA_MB`
- Topics:
  - `models.download.progress`
  - `models.changed`
  - `models.manifest.written`
  - `models.cas.gc`
  - `models.refreshed`
  - `state.read.model.patch`
- Read-models:
  - `models`
  - `models_metrics`
- References:
  - [architecture/artifacts_provenance.md](../architecture/artifacts_provenance.md)
- Notes:
  - Reserved provenance events and bundle export endpoints document lineage for audit.
  - Downloads honor preflight checks and quotas before admission.

### Asimov Capsule Guard

Alpha capsule lifecycle that refreshes reversible denies at runtime boundaries and emits telemetry for active guardrails.

- Feature: [Asimov Capsule Guard](feature_matrix.md#asimov-capsule-guard) (Future pack)
- Category: Security & Policy
- Scope: Future pack / runtime / operators / guardrails / alpha
- Owner: platform
- Depends on:
  - Policy & Gating Core
  - Egress Firewall & Ledger
  - Guardrail Gateway (Policy + Egress)
  - SSE + JSON Patch Streaming Contract
- Signals & Telemetry:
  - `policy.decision`
  - `rpu.trust.changed`
- HTTP:
  - `ANY /admin/* (X-ARW-Capsule)`
- Environment:
  - `ARW_TRUST_CAPSULES`
  - `ARW_GATING_DENY`
- Topics:
  - `policy.decision`
  - `rpu.trust.changed`
  - `policy.capsule.*`
- References:
  - [architecture/asimov_capsule_guard.md](../architecture/asimov_capsule_guard.md)
- Notes:
  - Extends gating capsules with leases so protections renew without restarts.
  - Instruments admin middleware, tool execution, and egress to refresh capsules proactively.
- Admin tooling surfaces capsule presets, live status, and audit trails via the web models console and CLI (`arw-cli capsule preset|audit|trust`).

### Cache Policy & Action Cache

Declarative cache manifest covering action cache keys, LLM reuse, semantic caching, and SSE delta persistence for predictable behavior across layers.

- Feature: [Tool Forge](feature_matrix.md#tool-forge) (Core kernel)
- Category: Runtime
- Scope: Core kernel / runtime / developers / data plane / plan
- Owner: platform
- Depends on:
  - Runtime Layout & Control Plane Priority
  - SSE + JSON Patch Streaming Contract
- Signals & Telemetry:
  - `task.completed`
  - `tool.cache`
  - `models.changed`
- HTTP:
  - `GET /admin/tools`
  - `POST /admin/tools/run`
  - `GET /admin/tools/cache_stats`
  - `GET /state/models_metrics`
- Environment:
  - `ARW_TOOLS_CACHE_CAP`
  - `ARW_TOOLS_CACHE_TTL_SECS`
  - `ARW_POLICY_VERSION`
  - `ARW_SECRETS_VERSION`
  - `ARW_TOOLS_CACHE_*`
  - `ARW_MODELS_METRICS_*`
- Topics:
  - `task.completed`
- References:
  - [architecture/cache_policy.md](../architecture/cache_policy.md)
  - [architecture/caching_layers.md](../architecture/caching_layers.md)
- Notes:
  - CAS-backed action cache pairs with W-TinyLFU fronts and digest-addressed blobs.
  - Future RocksDB tiers and resumable SSE streams extend coverage.

### Capability & Consent Ledger

Issues auditable, time-bound capability leases so the UI can explain why sensitive actions were allowed or denied.

- Category: Governance
- Scope: runtime / operators / governance / plan
- Owner: platform
- Depends on:
  - Policy & Gating Core
- Signals & Telemetry:
  - `policy.decision`
  - `policy.reloaded`
- References:
  - [architecture/capability_consent_ledger.md](../architecture/capability_consent_ledger.md)
- Notes:
  - Grants modeled as leases with TTLs feed a planned `/state/policy` read-model showing active permissions.
  - Denials and escalations record provenance alongside lease issuance.

### Compliance Mode

Workspace toggle that enforces approvals, extended retention, and provenance snapshots for regulated contexts.

- Category: Governance
- Scope: workspace / operators / governance / plan
- Owner: platform
- Depends on:
  - Versioning & Migration Backbone
  - Replay & Observability Stack
- References:
  - [architecture/compliance_mode.md](../architecture/compliance_mode.md)
- Notes:
  - Requires approvals for risky actions and surfaces active obligations in the UI.
  - Retains episode artifacts with provenance links for extended audit windows.

### Config Plane & Patch Engine

Atomic config patching workflow with dry-run, apply, and revert endpoints validated against schema maps before committing changes.

- Feature: [Config Plane](feature_matrix.md#config-plane) (Core kernel)
- Category: Configuration
- Scope: Core kernel / admin / operators / configuration / plan
- Owner: platform
- Depends on:
  - Versioning & Migration Backbone
  - Triad Kernel & Unified API
- Signals & Telemetry:
  - `config.patch.applied`
  - `logic.unit.reverted`
  - `logic.unit.applied`
- HTTP:
  - `GET /state/config`
  - `GET /state/config/snapshots`
  - `GET /state/config/snapshots/:id`
  - `POST /patch/apply`
  - `POST /patch/apply (dry_run=true)`
  - `POST /patch/revert`
  - `POST /patch/validate`
  - `GET /state/schema_map`
  - `POST /patch/infer_schema`
- Environment:
  - `ARW_SCHEMA_MAP`
- Topics:
  - `config.patch.applied`
  - `logic.unit.reverted`
- References:
  - [architecture/config_patch_engine.md](../architecture/config_patch_engine.md)
  - [configs/schema_map.json](https://github.com/t3hw00t/ARW/blob/main/configs/schema_map.json)
- Notes:
  - Validates config deltas against versioned JSON Schemas before widening permissions.
  - Emits audited events so permission changes stay rollback-ready.

### Context Working Set

Layered retrieval pipeline that assembles working, episodic, semantic, procedural, world, and artifact memories on demand with budgets and diversity guards.

- Feature: [Working Set Builder](feature_matrix.md#working-set-builder) (Core kernel)
- Category: Runtime
- Scope: Core kernel / runtime / developers / context / plan
- Owner: platform
- Depends on:
  - Memory Abstraction Layer & Memory Atlas
  - Triad Kernel & Unified API
- Signals & Telemetry:
  - `working_set.started`
  - `working_set.seed`
  - `working_set.expanded`
  - `working_set.expand_query`
  - `working_set.selected`
  - `working_set.completed`
  - `working_set.iteration.summary`
  - `working_set.error`
- HTTP:
  - `POST /context/assemble`
  - `POST /context/rehydrate`
- Environment:
  - `ARW_CONTEXT_LANES_DEFAULT`
  - `ARW_CONTEXT_K`
  - `ARW_CONTEXT_EXPAND_PER_SEED`
  - `ARW_CONTEXT_DIVERSITY_LAMBDA`
  - `ARW_CONTEXT_MIN_SCORE`
  - `ARW_CONTEXT_LANE_BONUS`
  - `ARW_CONTEXT_EXPAND_QUERY`
  - `ARW_CONTEXT_EXPAND_QUERY_TOP_K`
  - `ARW_CONTEXT_SCORER`
  - `ARW_CONTEXT_COVERAGE_MAX_ITERS`
  - `ARW_CONTEXT_STREAM_DEFAULT`
- Topics:
  - `working_set.started`
  - `working_set.seed`
  - `working_set.expanded`
  - `working_set.expand_query`
  - `working_set.selected`
  - `working_set.completed`
  - `working_set.iteration.summary`
  - `working_set.error`
- References:
  - [architecture/context_working_set.md](../architecture/context_working_set.md)
- Notes:
  - Information-gain gates and abstain/escalate rules prevent over-stuffing prompts.
  - Telemetry highlights thin coverage or low diversity for planners and dashboards.

### Data Governance & Privacy

Classification-driven handling that propagates tags across policies, memories, caches, and exports to enforce lifecycle controls.

- Category: Governance
- Scope: workspace / operators / governance / plan
- Owner: platform
- Depends on:
  - Policy & Gating Core
  - Memory Abstraction Layer & Memory Atlas
- Signals & Telemetry:
  - `memory.item.upserted`
  - `memory.item.expired`
  - `memory.link.put`
- References:
  - [architecture/data_governance.md](../architecture/data_governance.md)
- Notes:
  - Redact/forget flows and classification-aware allowlists govern caches, snapshots, and egress.
  - Per-episode classification summaries feed audit and export reports.

### Durability & Offline Resilience

Event journal plus periodic snapshots, idempotent tool actions, and conflict-aware merges keep work replayable even offline.

- Category: Runtime
- Scope: runtime / operators / infrastructure / plan
- Owner: platform
- Depends on:
  - Versioning & Migration Backbone
- References:
  - [architecture/durability.md](../architecture/durability.md)
- Notes:
  - Local journaling and reconciliation guard against data loss during offline sessions.
  - Three-way merges prefer explicit resolution with last-writer-wins limited to low-risk state.

### Egress Firewall & Ledger

Loopback proxy, DNS guard, filesystem scoping, and leased sensor access enforce explicit network scopes with auditable previews and decisions.

- Feature: [Egress Sentinel](feature_matrix.md#egress-sentinel) (Core kernel)
- Category: Security & Policy
- Scope: Core kernel / runtime / operators / guardrails / plan
- Owner: platform
- Depends on:
  - Policy & Gating Core
- Signals & Telemetry:
  - `egress.ledger.appended`
  - `egress.settings.updated`
  - `egress.preview`
- HTTP:
  - `POST /egress/preview`
  - `POST /egress/settings`
  - `GET /state/egress`
  - `GET /state/egress/settings`
- Environment:
  - `ARW_NET_POSTURE`
  - `ARW_SECURITY_POSTURE`
  - `ARW_NET_ALLOWLIST`
  - `ARW_EGRESS_BLOCK_IP_LITERALS`
  - `ARW_DNS_GUARD_ENABLE`
  - `ARW_EGRESS_PROXY_ENABLE`
  - `ARW_EGRESS_PROXY_PORT`
  - `ARW_EGRESS_LEDGER_ENABLE`
- Topics:
  - `egress.ledger.appended`
  - `egress.settings.updated`
- References:
  - [architecture/egress_firewall.md](../architecture/egress_firewall.md)
  - [guide/network_posture.md](../guide/network_posture.md)
- Notes:
  - Proxy tags traffic with correlation metadata and records previews plus decisions for audit.
  - Default posture keeps outbound access public-only until leases expand scope.

### Experiment Orchestrator

Provides first-class A/B/n and shadow experiments with assignment rules, per-variant budgets, and live deltas published to state views.

- Category: Runtime
- Scope: runtime / operators / orchestration / plan
- Owner: platform
- Depends on:
  - SSE + JSON Patch Streaming Contract
  - Versioning & Migration Backbone
- Signals & Telemetry:
  - `experiment.started`
  - `experiment.variant.chosen`
  - `experiment.result`
  - `experiment.completed`
  - `experiment.activated`
- HTTP:
  - `/state/experiments`
- References:
  - [architecture/experiment_orchestrator.md](../architecture/experiment_orchestrator.md)
- Notes:
  - Budget-aware admission keeps trials auditable and contained.
  - Logic Units Library surfaces inline performance deltas for operators.

### Federated Clustering

Home node with optional worker/broker roles share compute, filtered world diffs, and manifests while preserving single-node fast paths.

- Category: Runtime
- Scope: runtime / operators / infrastructure / plan
- Owner: platform
- Depends on:
  - Identity & Tenancy
  - Egress Firewall & Ledger
- Signals & Telemetry:
  - `cluster.node.advertise`
  - `cluster.node.changed`
  - `world.diff.rejected`
- References:
  - [architecture/cluster_federation.md](../architecture/cluster_federation.md)
- Notes:
  - Invite-only federation with signed manifests and node identifiers for deterministic replay.
  - Egress leases and budget guards meter contributions across nodes.

### Identity & Tenancy

Layered principals for User, Project, and AgentInstance scope capabilities, storage, caches, and logs to the narrowest owner.

- Category: Governance
- Scope: workspace / operators / governance / beta
- Owner: platform
- Signals & Telemetry:
  - `policy.decision`
- References:
  - [architecture/identity_tenancy.md](../architecture/identity_tenancy.md)
- Notes:
  - Default action scope flows from AgentInstance up to Project to User only when necessary.
  - Namespaced storage paths (`user://`, `project://`, `agent://`) align data placement with tenancy boundaries.

### Lightweight Mitigations

Planned bundle of pragmatic safeguards: memory quarantine, project isolation, manifest pinning, hardened browsing, DNS guard, and accelerator hygiene.

- Category: Security & Policy
- Scope: runtime / operators / assurance / plan
- Owner: platform
- Depends on:
  - AppSec Harness
  - Egress Firewall & Ledger
- Signals & Telemetry:
  - `memory.quarantined`
  - `world.diff.queued`
  - `world.diff.rejected`
- References:
  - [architecture/lightweight_mitigations.md](../architecture/lightweight_mitigations.md)
- Notes:
  - Security postures (Relaxed/Standard/Strict) gate risky automation and highlight review queues.
  - Instrumented events cover quarantine, manifests, secrets hygiene, and network anomalies.

### Memory Abstraction Layer & Memory Atlas

Memory overlay service on top of the MAL schema that exposes `memory.*` actions, hybrid recall, and explainable context packs for every agent.

- Feature: [Memory Atlas](feature_matrix.md#memory-atlas) (Core kernel)
- Category: Runtime
- Scope: Core kernel / runtime / developers / data plane / plan
- Owner: platform
- Depends on:
  - Triad Kernel & Unified API
- Signals & Telemetry:
  - `memory.item.upserted`
  - `memory.item.expired`
  - `memory.pack.journaled`
- HTTP:
  - `POST /actions (memory.upsert)`
  - `POST /actions (memory.search)`
  - `POST /actions (memory.pack)`
  - `GET /state/memory`
  - `GET /state/memory/recent`
- Topics:
  - `memory.item.upserted`
  - `memory.item.expired`
  - `memory.pack.journaled`
- Storage:
  - `memory_items`
  - `memory_vec`
  - `memory_vec_map`
  - `memory_keywords`
- Read-models:
  - `memory`
- References:
  - [architecture/memory_abstraction.md](../architecture/memory_abstraction.md)
  - [architecture/memory_lifecycle.md](../architecture/memory_lifecycle.md)
  - [architecture/memory_overlay_service.md](../architecture/memory_overlay_service.md)
- Notes:
  - Lane-specific budgets, TTLs, and lifecycle policies keep the corpus explainable and auditable.
  - Overlay actions now flow entirely through `/actions`; legacy `/memory/*` REST shims have been removed.
  - Retrieval journaling captures scores/diversity decisions for working-set diagnostics.

### Policy & Gating Core

Central gating service with named keys, deny contracts, and capsule adoption so sensitive operations stay lease-gated and auditable across the runtime.

- Feature: [Policy & Lease Facade](feature_matrix.md#policy-lease-facade) (Core kernel)
- Category: Security & Policy
- Scope: Core kernel / runtime / operators / guardrails / beta
- Owner: platform
- Depends on:
  - Triad Kernel & Unified API
- Signals & Telemetry:
  - `policy.decision`
  - `policy.reloaded`
- HTTP:
  - `GET /state/policy`
  - `POST /policy/reload`
  - `POST /policy/simulate`
  - `POST /leases`
  - `GET /state/leases`
- Environment:
  - `ARW_POLICY_FILE`
  - `ARW_SECURITY_POSTURE`
- Config:
  - `configs/gating.toml`
  - `ARW_GATING_DENY`
- Topics:
  - `policy.decision`
  - `policy.reloaded`
- Storage & Records:
  - `policy deny sets`
  - `capsule leases`
- References:
  - [GATING_KEYS.md](../GATING_KEYS.md)
  - [guide/policy_permissions.md](../guide/policy_permissions.md)
  - [crates/arw-core/src/gating.rs](https://github.com/t3hw00t/ARW/blob/main/crates/arw-core/src/gating.rs)
- Notes:
  - Merges boot denies, runtime contracts, and propagated capsules into a single guardrail surface.
  - Ingress middleware validates admin tokens and optional capsules before routing requests.

### Replay & Observability Stack

Replay bundles pin models, tools, policies, and inputs so reruns compare outputs while telemetry aligns traces, metrics, and logs per corr_id.

- Category: Runtime
- Scope: runtime / operators / assurance / plan
- Owner: platform
- Depends on:
  - Versioning & Migration Backbone
  - Artifacts Provenance & Model CAS
- Signals & Telemetry:
  - `actions.completed`
  - `probe.metrics`
- References:
  - [architecture/replay_time_travel.md](../architecture/replay_time_travel.md)
  - [architecture/observability_otel.md](../architecture/observability_otel.md)
- Notes:
  - Episode spans map to OpenTelemetry traces while respecting data governance redaction defaults.
  - Policy denials and tool actions remain explainable across audits and migrations.

### Runtime Layout & Control Plane Priority

Separates interactive control plane work from background tasks, prioritizing low-latency streaming of earliest useful work.

- Feature: [Snappy Governor](feature_matrix.md#snappy-governor) (Core kernel)
- Category: Runtime
- Scope: Core kernel / runtime / developers / infrastructure / beta
- Owner: platform
- Depends on:
  - SSE + JSON Patch Streaming Contract
- Signals & Telemetry:
  - `snappy.notice`
  - `snappy.detail`
  - `state.read.model.patch`
- HTTP:
  - `GET /metrics`
  - `GET /state/route_stats`
- Environment:
  - `ARW_SNAPPY_I2F_P95_MS`
  - `ARW_SNAPPY_FIRST_PARTIAL_P95_MS`
  - `ARW_SNAPPY_FULL_RESULT_P95_MS`
  - `ARW_SNAPPY_PUBLISH_MS`
- Topics:
  - `snappy.notice`
  - `snappy.detail`
  - `state.read.model.patch`
- Read-models:
  - `route_stats`
  - `snappy`
- References:
  - [architecture/runtime_layout.md](../architecture/runtime_layout.md)
  - [architecture/performance.md](../architecture/performance.md)
- Notes:
  - SSE with JSON Patch keeps updates under 150–250 ms cadence while background work yields within loops.
  - Systemd weights and queue separation preserve responsiveness for interactive workloads.

### SSE + JSON Patch Streaming Contract

Defines the incremental streaming protocol that delivers RFC 6902 patches over SSE with resume semantics and canonical topics.

- Feature: [Event Spine](feature_matrix.md#event-spine) (Core kernel)
- Category: Runtime
- Scope: Core kernel / runtime / developers / data plane / beta
- Owner: platform
- Depends on:
  - Runtime Layout & Control Plane Priority
- Signals & Telemetry:
  - `state.read.model.patch`
- HTTP:
  - `GET /events`
- Query:
  - `?replay=`
  - `Last-Event-ID`
- Topics:
  - `state.read.model.patch`
- Read-models:
  - `models`
  - `models_metrics`
  - `episodes`
  - `projects`
  - `route_stats`
  - `snappy`
- References:
  - [architecture/sse_patch_contract.md](../architecture/sse_patch_contract.md)
- Notes:
  - Encourages clients to apply patches locally and rely on canonical topic constants shared across surfaces.
  - Startup handshake provides resume hints so UI reconnects without fetching full snapshots.

### Scheduler & Governor

Runtime governor enforces fair queues, preemption, and kill-switches per device or project so workloads degrade gracefully.

- Category: Runtime
- Scope: runtime / operators / infrastructure / plan
- Owner: platform
- Depends on:
  - Runtime Layout & Control Plane Priority
  - Capability & Consent Ledger
- Signals & Telemetry:
  - `governor.changed`
  - `actions.running`
  - `actions.completed`
  - `actions.failed`
- References:
  - [architecture/scheduler_governor.md](../architecture/scheduler_governor.md)
  - [architecture/scheduling_backpressure.md](../architecture/scheduling_backpressure.md)
- Notes:
  - Honors GPU/sandbox caps and capability leases before admitting work.
  - Publishes throughput and health data via `/state/runtime_matrix` for scheduling hints.

### Self-Model (Metacognition)

Scoped self-model capturing identity, capabilities, competence, calibration, and resource curves to drive transparent planning and abstain/escalate behavior.

- Feature: [Self Card + Forecasts](feature_matrix.md#self-card-forecasts) (Core kernel)
- Category: Runtime
- Scope: Core kernel / runtime / operators / orchestration / plan
- Owner: platform
- Depends on:
  - SSE + JSON Patch Streaming Contract
  - Policy & Gating Core
- Signals & Telemetry:
  - `self.model.proposed`
  - `self.model.updated`
- HTTP:
  - `GET /state/self`
  - `GET /state/self/:agent`
  - `POST /admin/self_model/propose`
  - `POST /admin/self_model/apply`
- Topics:
  - `self.model.proposed`
  - `self.model.updated`
- Storage & Records:
  - `<state>/self/{agent}.json`
- References:
  - [architecture/self_model.md](../architecture/self_model.md)
- Notes:
  - Keeps evaluation metrics (calibration, risk–coverage, competence) tied to agent decisions.
  - Proposals require human approval for scope changes and cite provenance for replay.

### Supply-Chain Trust

Signed artifacts, manifests, and SBOMs feed sandboxed execution with provenance tracking to anchor plugin and model integrity.

- Category: Security & Policy
- Scope: build / operators / assurance / plan
- Owner: platform
- References:
  - [architecture/supply_chain_trust.md](../architecture/supply_chain_trust.md)
  - [developer/ci.md](../developer/ci.md)
- Notes:
  - Trust stores for issuers/keys back verification workflows.
  - Desktop clients map OS-level capability prompts to ARW policies to avoid privilege escalation.

### UI Screenshot Tools

Capture, annotate, and OCR tools return screenshot metadata, enforce io:screenshot/io:ocr leases, and publish gallery events for UI workflows.

- Feature: [Screenshot Capture Pipeline](feature_matrix.md#screenshot-capture-pipeline) (Opt-in pack)
- Category: UX
- Scope: Opt-in pack / runtime / operators / experience / beta
- Owner: platform
- Depends on:
  - Policy & Gating Core
  - Cache Policy & Action Cache
  - SSE + JSON Patch Streaming Contract
- Signals & Telemetry:
  - `screenshots.captured`
- HTTP:
  - `POST /admin/tools/run`
- Tools:
  - `ui.screenshot.capture`
  - `ui.screenshot.annotate_burn`
  - `ui.screenshot.ocr`
- Topics:
  - `screenshots.captured`
- Storage:
  - `.arw/screenshots/YYYY/MM/DD/`
- References:
  - [architecture/screenshot_capture_pipeline.md](../architecture/screenshot_capture_pipeline.md)
  - [guide/screenshots.md](../guide/screenshots.md)
- Notes:
  - Launcher integrations trigger captures and render previews with annotate/OCR quick actions.
  - Lease gating keeps capture and OCR auditable with Activity lane telemetry.

### Unified Object Graph & Event Stream

Shared object graph and SSE event stream keep Project Hub, Chat, Training Park, and manager views consistent across inventories and live updates.

- Feature: [Project Map (World Model)](feature_matrix.md#project-map-world-model) (Core kernel)
- Category: Runtime
- Scope: Core kernel / ui / operators / data plane / beta
- Owner: platform
- Depends on:
  - SSE + JSON Patch Streaming Contract
  - Runtime Layout & Control Plane Priority
- Signals & Telemetry:
  - `world.updated`
  - `episodes.*`
  - `tools.*`
  - `policy.*`
  - `models.*`
- HTTP:
  - `GET /state/observations`
  - `GET /state/beliefs`
  - `GET /state/intents`
  - `GET /state/actions`
  - `GET /state/episodes`
- Topics:
  - `world.updated`
- References:
  - [architecture/object_graph.md](../architecture/object_graph.md)
- Notes:
  - `GET /events` streams with corr_id stitching keep timelines authoritative.
  - Manager views edit global inventories while projects and agents reference them via scoped belief graphs.

### Versioning & Migration Backbone

Add-only versioning for prompts, recipes, policies, flows, and tool schemas so operational changes remain traceable and reversible.

- Category: Runtime
- Scope: runtime / operators / configuration / beta
- Owner: platform
- Signals & Telemetry:
  - `logic.unit.installed`
  - `logic.unit.applied`
  - `logic.unit.reverted`
- References:
  - [architecture/versioning_migration.md](../architecture/versioning_migration.md)
- Notes:
  - Episodes capture effective configs (model hash, tool versions, policies, seeds) for deterministic replay.
  - Migrations stay additive with published deprecation windows to avoid breaking deployed logic units.
