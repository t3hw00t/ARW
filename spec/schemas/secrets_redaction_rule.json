{
  "$id": "https://arw/spec/schemas/secrets_redaction_rule.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Secrets Redaction Rule",
  "description": "Rule describing how to detect and redact secrets in logs, snapshots, and previews.",
  "type": "object",
  "properties": {
    "id": { "type": "string" },
    "kind": { "type": "string", "enum": ["token", "key", "pattern"] },
    "pattern": { "type": "string", "description": "Regex or glob to detect secret." },
    "hint": { "type": "string", "description": "Optional hint (name of env/secret)." },
    "replacement": { "type": "string", "default": "***" },
    "enabled": { "type": "boolean", "default": true }
  },
  "required": ["id", "kind"],
  "additionalProperties": false
}

