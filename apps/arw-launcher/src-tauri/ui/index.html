<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Agent Hub (ARW) Launcher</title>
    <link rel="stylesheet" href="tokens.css" />
    <link rel="stylesheet" href="ui-kit.css" />
    <link rel="stylesheet" href="common.css" />
    <link rel="stylesheet" href="index.css" />
    <script src="common.js" defer></script>
    <script type="module" src="sidecar.js"></script>
    <script src="index.js" defer></script>
  </head>
  <body data-page="index">
    <a href="#setup" class="skip-link">Skip to setup checklist</a>
    <div class="wrap launcher-wrap">
      <section class="card launcher-hero">
        <div class="hero-head">
          <div class="hero-heading">
            <h1>Agent Hub Home</h1>
            <p class="hero-copy">Follow the checklist to bring your assistants online, then launch the workspace that fits your goal.</p>
            <ol class="hero-summary">
              <li>Run the local service or connect to a trusted remote base.</li>
              <li>Save your admin token once so secure tooling unlocks automatically.</li>
              <li>Launch the workspace or diagnostics panel you need.</li>
            </ol>
          </div>
          <div class="hero-status" role="status" aria-live="polite">
            <span class="status-chip">
              <span class="dot" id="svc-dot" aria-hidden="true"></span>
              <span class="status-body">
                <strong>Connection</strong>
                <small id="svc-text">unknown</small>
              </span>
            </span>
            <p class="status-hint">Start with Step&nbsp;1. We update this indicator after every health check.</p>
          </div>
        </div>
      </section>
      <section class="card quickstart" id="setup" aria-labelledby="setupTitle">
        <header class="section-head">
          <span class="section-tag">Setup checklist</span>
          <h2 id="setupTitle">Launch in three guided steps</h2>
          <p class="dim">We surface the most common actions in each step and keep expert shortcuts one click away. Complete the steps in order or let Agent Hub detect what is already configured.</p>
        </header>
        <ol class="quickstart-steps setup-flow">
          <li class="quickstart-step setup-step">
            <div class="step-head">
              <span class="step-index" aria-hidden="true">1</span>
              <div>
                <h3>Bring Agent Hub online</h3>
                <p class="dim">Start the local service or reconnect to a saved remote. We run health checks automatically and update the status badge above.</p>
              </div>
              <div class="step-status step-status--pending" id="status-step-service" role="status" aria-live="polite">
                <span class="step-status-dot" aria-hidden="true"></span>
                <span class="step-status-text">Checking service…</span>
              </div>
            </div>
            <div class="step-body step-body--grid">
              <div class="button-row emphasis step-actions">
                <button id="btn-start" class="primary" title="Start local service">Start Service</button>
                <button id="btn-stop" class="ghost" title="Stop local service">Stop Service</button>
                <button id="btn-health" class="ghost" title="Check service health">Check Health</button>
              </div>
              <div class="button-row step-actions">
                <button id="btn-open" class="primary" title="Open Debug UI in browser">Open Debug UI</button>
                <button id="btn-open-window" class="ghost" title="Open Debug UI in window">Open in Window</button>
              </div>
              <div class="button-row step-actions">
                <button id="btn-log-file" class="ghost" title="Open latest service log" disabled>Open Service Log</button>
              </div>
              <div class="step-status-block">
                <p class="step-hint dim">Need to troubleshoot? The Debug UI mirrors the browser panels, and the log shortcut jumps to the current stdout/stderr file.</p>
                <p class="step-hint dim" data-mode="expert-only">Prefer scripts? Restart headless with <code>bash scripts/start.sh --service-only --wait-health --admin-token "$ARW_ADMIN_TOKEN"</code>.</p>
                <div class="health-wrap" role="status" aria-live="polite">
                  <span id="health" class="dim"></span>
                  <span id="healthMeta" class="dim">Waiting for the first check…</span>
                </div>
              </div>
            </div>
          </li>
          <li class="quickstart-step setup-step" id="step-token">
            <div class="step-head">
              <span class="step-index" aria-hidden="true">2</span>
              <div>
                <h3>Secure your workspace</h3>
                <p class="dim">Store your admin token once so Projects, Conversations, and automation tooling unlock automatically. The value stays local to this device.</p>
              </div>
              <div class="step-status step-status--pending" id="status-step-token" role="status" aria-live="polite">
                <span class="step-status-dot" aria-hidden="true"></span>
                <span class="step-status-text">Awaiting token</span>
              </div>
            </div>
            <div class="step-body">
              <div class="pref-field">
                <label for="admintok">Admin token <small class="dim">(required for Projects, Conversations, Training)</small></label>
                <div class="input-with-toggle token-control">
                  <input id="admintok" type="password" autocomplete="off" placeholder="Paste admin token"/>
                  <button id="btn-token-toggle" class="ghost mini" type="button" aria-pressed="false" aria-label="Show admin token">Show</button>
                  <button id="btn-token-generate" class="ghost mini" type="button" aria-label="Generate a new admin token">Generate</button>
                  <button id="btn-token-copy" class="ghost mini" type="button" aria-label="Copy admin token">Copy</button>
                  <button id="btn-token-test" class="ghost mini" type="button" aria-label="Test admin token">Test</button>
                  <button id="btn-token-restart" class="ghost mini" type="button" aria-label="Copy restart command (Shift for alternate shell)" title="Copy restart command (Shift for alternate shell)">Copy restart</button>
                </div>
                <p class="field-note token-note">We only use this token against the active base. Test it before you restart. <button id="btn-token-guide" class="link-button" type="button">Need a refresher?</button></p>
                <p id="tokenStatus" class="field-note token-status" role="status" aria-live="polite"></p>
              </div>
              <details class="hero-preferences" data-role="advanced">
                <summary aria-controls="heroAdvanced">Connection &amp; alerts</summary>
                <div class="hero-meta" id="heroAdvanced">
                  <div class="pref-field">
                    <label for="port">Preferred port</label>
                    <input id="port" aria-label="Port" type="number" min="1" max="65535" value="8091"/>
                    <p class="field-note">Update this when your service runs on another port or when you connect to a remote deployment.</p>
                    <span id="baseBadge" class="badge base-badge mono" aria-live="polite"></span>
                  </div>
                  <div class="pref-field pref-toggle">
                    <label>
                      <input id="autostart" type="checkbox"/>
                      <span>
                        <strong>Start service with launcher</strong>
                        <small>Run <code>arw-server</code> automatically when the launcher opens.</small>
                      </span>
                    </label>
                  </div>
                  <div class="pref-field pref-toggle">
                    <label>
                      <input id="notif" type="checkbox" checked/>
                      <span>
                        <strong>Desktop notifications</strong>
                        <small>Get alerts when health changes or downloads finish.</small>
                      </span>
                    </label>
                  </div>
                  <div class="pref-field pref-toggle">
                    <label>
                      <input id="loginstart" type="checkbox"/>
                      <span>
                        <strong>Launch at login</strong>
                        <small>Keep Agent Hub ready after you sign in.</small>
                      </span>
                    </label>
                  </div>
                  <div class="pref-field pref-toggle">
                    <label>
                      <input id="mascotEnabled" type="checkbox"/>
                      <span>
                        <strong>Show mascot overlay</strong>
                        <small>Pin a floating companion that mirrors service status.</small>
                      </span>
                    </label>
                    <button id="btn-open-mascot" class="ghost mini" type="button" aria-label="Show mascot overlay">Show now</button>
                  </div>
                  <div class="pref-field">
                    <label for="connectionSelect">Active connection</label>
                    <div class="connection-select">
                      <select id="connectionSelect" aria-label="Active connection">
                        <option value="" selected>Local default (127.0.0.1)</option>
                      </select>
                      <button id="btn-open-connections" class="ghost mini" type="button" aria-label="Manage connections">Manage</button>
                    </div>
                    <p class="field-note">Flip between local and saved remote stacks without leaving Home.</p>
                  </div>
                </div>
              </details>
              <div class="hero-footer">
                <div class="hero-actions">
                  <button id="btn-save" type="button" class="ghost" title="Save preferences" disabled>Save preferences</button>
                  <span id="prefsStatus" class="dim" data-state="clean" role="status" aria-live="polite">All changes saved</span>
                </div>
                <span id="statusBadges" class="badges"></span>
              </div>
              <p class="step-hint dim" data-mode="guided-only">Need a token? Run <code>bash scripts/start.sh --new-token</code> or ask your operator for a shared credential.</p>
              <p class="step-hint dim" data-mode="expert-only">Shift-click “Copy restart” to grab a PowerShell command when you are on Windows.</p>
              <div id="tokenCallout" class="hero-callout" role="alert" hidden>
                <span class="hero-callout-icon" aria-hidden="true">!</span>
                <span>
                  <strong>Secure setup required.</strong>
                  <span id="tokenCalloutBody">Paste an admin token to unlock Projects, Conversations, Training, and other admin surfaces.</span>
                </span>
                <button id="btn-token-callout" class="ghost mini" type="button" aria-label="Open admin token controls">Set token</button>
              </div>
              <div id="baseCallout" class="hero-callout" role="alert" hidden>
                <span class="hero-callout-icon" aria-hidden="true">!</span>
                <span>
                  <strong>Secure remote access.</strong>
                  <span id="baseCalloutBody">Remote base is using plain HTTP. Switch to HTTPS or a trusted tunnel before sharing admin surfaces.</span>
                </span>
                <button id="btn-base-callout" class="ghost mini" type="button" aria-label="Open network hardening guide">Network guide</button>
              </div>
              <div id="desktopCallout" class="hero-callout" role="alert" hidden>
                <span class="hero-callout-icon" aria-hidden="true">!</span>
                <span>
                  <strong>Desktop launcher features.</strong>
                  <span id="desktopCalloutBody">Starting or stopping the service and viewing local logs require the desktop launcher or CLI scripts.</span>
                </span>
              </div>
            </div>
          </li>
          <li class="quickstart-step setup-step">
            <div class="step-head">
              <span class="step-index" aria-hidden="true">3</span>
              <div>
                <h3>Launch your workspace</h3>
                <p class="dim">Choose the window that matches the work you want to do. Buttons stay disabled until the service and token are ready.</p>
              </div>
              <div class="step-status step-status--pending" id="status-step-workspaces" role="status" aria-live="polite">
                <span class="step-status-dot" aria-hidden="true"></span>
                <span class="step-status-text">Locked until steps 1–2</span>
              </div>
            </div>
            <div class="step-body">
              <div class="launch-groups">
                <div class="launch-group">
                  <h4>Quick start</h4>
                  <div class="button-column">
                    <button id="btn-hub" class="primary" title="Open Projects workspace">Projects</button>
                    <p class="button-hint">Manage files, notes, and run history in one place.</p>
                    <button id="btn-chat" class="ghost" title="Open Conversations workspace">Conversations</button>
                    <p class="button-hint">Chat with assistants and share context without leaving Agent Hub.</p>
                  </div>
                </div>
                <div class="launch-group" data-mode="expert-only">
                  <h4>Automation &amp; diagnostics</h4>
                  <div class="button-column">
                    <button id="btn-training" class="ghost" title="Open Training dashboard">Training runs</button>
                    <p class="button-hint">Monitor cascades, A/B jobs, and telemetry.</p>
                    <button id="btn-trial" class="ghost" title="Open Trial coordinator">Experiment control</button>
                    <p class="button-hint">Coordinate staged experiments and capture approvals.</p>
                    <button id="btn-events" class="ghost" title="Open Events window">Live events</button>
                    <p class="button-hint">Watch real-time activity streams.</p>
                    <button id="btn-logs" class="ghost" title="Open Logs window">Service logs</button>
                    <p class="button-hint">Inspect runtime logs and filter noise.</p>
                    <button id="btn-models" class="ghost" title="Open Models manager">Model registry</button>
                    <p class="button-hint">Review managed runtimes and restart budgets.</p>
                  </div>
                </div>
                <div class="launch-group">
                  <h4>Support &amp; preferences</h4>
                  <div class="button-column">
                    <button id="btn-connections" class="ghost" title="Open Connections manager">Connections</button>
                    <p class="button-hint">Manage remote bases, pooled compute, and shared credentials.</p>
                    <button id="btn-mascot" class="ghost" title="Show mascot overlay">Mascot overlay</button>
                    <p class="button-hint">Open the floating helper with live hints.</p>
                    <button id="btn-settings" class="primary" title="Open launcher settings window">Launcher settings</button>
                    <p class="button-hint">Adjust launch behaviour, accessibility options, and WebView status.</p>
                    <button id="btn-updates" class="ghost" title="Open releases page">Check updates</button>
                    <p class="button-hint">Grab the latest builds and release notes.</p>
                    <button id="btn-shortcuts" class="ghost" title="Show keyboard shortcuts">Shortcuts</button>
                    <p class="button-hint">Open the in-launcher shortcut reference.</p>
                    <button id="btn-help" class="ghost" title="Open documentation">Help</button>
                    <p class="button-hint">Read the online guide for detailed support.</p>
                  </div>
                </div>
              </div>
              <p id="workspaceHint" class="dim workspace-hint" role="status" aria-live="polite" hidden></p>
              <p class="step-hint dim">Toggle Guided / Expert mode from the top bar whenever you want more or fewer controls.</p>
            </div>
          </li>
        </ol>
      </section>
      <div class="launcher-grid">
        <section class="card downloads-card" aria-labelledby="downloadsTitle">
          <header class="section-head">
            <h2 id="downloadsTitle">Active downloads</h2>
            <p class="dim">Runtime assets in flight clear automatically when complete.</p>
          </header>
          <div id="dlmini" class="badge-row" role="status" aria-live="polite"></div>
        </section>
      </div>
    </div>
  </body>
</html>
