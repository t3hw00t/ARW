/* tokens.css provides variables */

html, body{
  height:100%; margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, sans-serif;
  background: radial-gradient(1200px 600px at 30% -10%, #ffffff, #f7f7f9 55%, #f1f5f9), var(--surface-muted);
  color:var(--color-ink)
}
/* Responsive type scale */
body{ font-size: clamp(14px, 1.6vw, 16px) }

/* Skip link */
.skip-link{ position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden }
.skip-link:focus{ position:static; width:auto; height:auto; padding:6px 10px; border:1px solid var(--color-line); border-radius:8px; background:#fff; box-shadow: var(--shadow-2); z-index:10000 }
/* Screen-reader only */
.sr-only{ position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0 }

.wrap{ padding:var(--sp4); display:grid; gap:var(--sp4); position:relative }
.wrap::before{
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image: var(--noise);
  opacity:.5; mix-blend-mode: soft-light;
}
.card{ padding:var(--sp5); border:1px solid var(--color-line); border-radius:12px; background: linear-gradient(180deg,#ffffff, #fafafa); box-shadow: var(--shadow-2) }
.row{ display:flex; gap:var(--sp2); flex-wrap:wrap; align-items:center }

button{
  padding:8px 12px; border-radius:8px; border:1px solid #cfd6de;
  background-image: linear-gradient(180deg, #ffffff, #f3f4f6), var(--noise);
  background-blend-mode: overlay, normal; color:#111; cursor:pointer;
  box-shadow: var(--shadow-1), 0 8px 18px rgba(0,0,0,0.06);
  transition: transform .06s ease, box-shadow .12s ease;
}
button:hover{ transform: translateY(-0.5px); box-shadow: 0 1px 0 rgba(255,255,255,0.95) inset, 0 14px 28px rgba(0,0,0,0.08) }
button:active{ transform: translateY(0); box-shadow: 0 0 0 rgba(0,0,0,0.0), 0 4px 8px rgba(0,0,0,0.08) }

button.primary{ border-color: var(--color-brand-copper); background-image: linear-gradient(180deg, var(--color-brand-copper), var(--color-brand-copper-dark)), var(--noise); color:#fff }
button.ghost{
  background: transparent; border-color: #cfd6de;
}

table{ width:100%; border-collapse:collapse }
th,td{ border-bottom:1px solid #eee; padding:6px 8px; text-align:left }
th{ color:#555; font-weight:600 }

.mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace }
.dim{ color: var(--color-muted) }
.ok{ color: var(--status-ok) }
.bad{ color: var(--status-bad) }

.badge{ display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border:1px solid var(--color-line); border-radius:999px; font-size:12px; background:#fff; box-shadow:0 1px 0 rgba(255,255,255,0.9) inset }
.dot{ width:8px; height:8px; border-radius:999px; background:#aaa; display:inline-block }
.dot.ok{ background: var(--status-ok) }
.dot.bad{ background: var(--status-bad) }

.bar{ height:8px; border:1px solid var(--color-line); border-radius:8px; overflow:hidden; margin:4px 0; background:linear-gradient(180deg,#fff,#f7f7f7) }
.bar>i{ display:block; height:8px; width:0%; background: linear-gradient(90deg, var(--color-accent-teal), var(--color-accent-teal-light)) }

.toast-wrap{ position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index: 9999 }
.toast{ background: #0f172a; color:#fff; padding:8px 12px; border-radius:10px; opacity:.95; box-shadow: 0 14px 34px rgba(0,0,0,0.22) }

input, select, textarea{ font:inherit; color:var(--color-ink); border:1px solid var(--color-line); border-radius:8px; padding:6px 8px; background:#ffffff; box-shadow: 0 1px 0 rgba(255,255,255,0.9) inset }
input:focus, select:focus, textarea:focus{ outline: none; border-color: var(--color-brand-copper); box-shadow: 0 0 0 3px rgba(var(--brand-copper-rgb), 0.15) }

/* Iconography */
.icons{ display:inline-flex; gap:6px; align-items:center; margin-right:6px }
.ico{ width:14px; height:14px; display:inline-block; vertical-align:-2px; color:currentColor; opacity:.9 }
.ico.ok{ color: var(--status-ok) }
.ico.warn{ color: var(--status-warn) }
.ico.bad{ color: var(--status-bad) }
.ico.info{ color: var(--color-muted) }
.ico.accent{ color: var(--color-accent-teal) }

/* Better keyboard focus */
button:focus-visible, a:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible{ outline: 2px solid rgba(var(--brand-copper-rgb), 0.55); outline-offset: 2px }

/* Touch-friendly targets */
@media (pointer: coarse){
  button{ padding:12px 16px; border-radius:10px }
  input, select, textarea{ padding:10px 12px }
}

/* Reduce motion when requested */
@media (prefers-reduced-motion: reduce){
  *{ transition: none !important; animation: none !important }
}

/* Dark mode tuning */
@media (prefers-color-scheme: dark){
  html, body{ background: radial-gradient(1200px 600px at 30% -10%, var(--surface-muted), #0b0d12 55%, #090b10) }
  .card{ background: linear-gradient(180deg,#12161f,#0f141a); border-color: var(--color-line); box-shadow: 0 12px 30px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.04) }
  button{ color:#e5e7eb; border-color:#39404a; box-shadow: 0 1px 0 rgba(255,255,255,0.06) inset, 0 8px 18px rgba(0,0,0,0.35); background-image: linear-gradient(180deg,#1a202b,#131822), var(--noise) }
  button.primary{ background-image: linear-gradient(180deg, var(--color-brand-copper-dark), #6f3e1d), var(--noise) }
  .badge{ background:#12161f; border-color: var(--color-line); box-shadow: 0 1px 0 rgba(255,255,255,0.06) inset }
  .bar{ background: linear-gradient(180deg, #0f141a, #0b0f15) }
  .bar>i{ background: linear-gradient(90deg, var(--color-accent-teal), #12897f) }
  input, select, textarea{ background:#0f141a; color:#e5e7eb; border-color: var(--color-line); box-shadow: 0 1px 0 rgba(255,255,255,0.06) inset }
}

/* Sidecar scaffold */
.layout {
  display:grid; grid-template-columns: 1fr 320px; gap: var(--sp4);
}
.layout.full { grid-template-columns: 1fr }
.arw-sidecar {
  position:sticky; top:12px; align-self:start;
  border:1px solid var(--color-line); border-radius:12px; padding:8px;
  background: linear-gradient(180deg,#ffffff,#fafafa);
  box-shadow: 0 12px 30px rgba(0,0,0,0.06), inset 0 1px 0 rgba(255,255,255,0.65);
}
.arw-sidecar section { border-bottom:1px dashed var(--color-line); padding:4px 0 }
.arw-sidecar section:last-child{ border-bottom:none }
.arw-sidecar h3 { margin:6px 0; font-size:14px; color:#374151; cursor:pointer; display:flex; align-items:center; gap:6px }
.arw-sidecar section.collapsed > .lane-body { display:none }
.arw-sidecar .lane-body { max-height: 260px; overflow:auto }
.arw-sidecar .evt { font-size:12px; padding:2px 0 }

/* Panels grid helpers */
.grid { display:grid; gap: var(--sp3) }
.grid.cols-2 { grid-template-columns: 1fr 1fr }
.grid.cols-3 { grid-template-columns: 1fr 1fr 1fr }

/* Command Palette */
.palette-wrap{ position: fixed; inset:0; display:none; place-items:center; background: rgba(4,7,12,0.35); backdrop-filter: blur(4px) saturate(120%); z-index:99999 }
.palette{ width:min(720px, 92vw); background: linear-gradient(180deg,#ffffff,#f6f7f9); border:1px solid var(--color-line); border-radius:12px; box-shadow: 0 18px 50px rgba(0,0,0,0.18) }
.palette header{ padding:10px 12px; border-bottom:1px solid var(--color-line); display:flex; gap:8px; align-items:center }
.palette header input{ width:100% }
.palette ul{ list-style:none; margin:0; padding: 6px 0; max-height: 50vh; overflow:auto }
.palette li{ padding:8px 12px; display:flex; align-items:center; gap:8px; cursor:pointer }
.palette li:hover, .palette li.active{ background:#f3f4f6 }
.palette .k{ font-size:12px; color:#6b7280 }
.palette .hint{ margin-left:auto; color:#6b7280; font-size:12px }

/* Compare panel */
.cmp-tabs{ display:flex; gap:6px; margin-bottom:6px }
.cmp-tabs button{ padding:6px 10px }
.cmp-tabs button.active{ border-color:#b87333 }
.cmp-code{ background:linear-gradient(180deg,#ffffff,#fafafa); border:1px solid var(--color-line); border-radius:8px; padding:8px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size:12px; overflow:auto; max-height: 260px }
.cmp-line.add{ background: #ecfdf5 }
.cmp-line.del{ background: #fef2f2 }
.hl-key{ color:#6b7280 }
.hl-str{ color:#166534 }
.hl-num{ color:#1d4ed8 }
.hl-bool{ color:#b45309 }
.hl-null{ color:#9ca3af }
/* Inline name highlight for file search */
.hl-match{ background: rgba(27,179,163,0.15); border-bottom: 1px solid var(--color-accent-teal); border-radius: 3px; }
/* Focus styling for file tree rows */
[data-row="1"]:focus{ outline: 2px solid rgba(var(--brand-copper-rgb), 0.5); outline-offset: 2px; background: rgba(27,179,163,0.06) }
/* Compact controls */
.controls{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin:6px 0 }
.controls .spacer{ flex:1 }
.pill{ display:inline-flex; gap:6px; align-items:center; padding:4px 8px; border:1px solid var(--color-line); border-radius:999px; background: linear-gradient(180deg,#ffffff,#f6f7f9); font-size:12px }
.pill .tag{ font-weight:600; color:#374151 }

/* Image slider */
.img-compare{ position: relative; height: 260px; border:1px solid var(--color-line); border-radius:8px; overflow:hidden; background:#111 }
.img-compare img{ position:absolute; inset:0; width:100%; height:100%; object-fit:contain }
.img-compare .top{ clip-path: inset(0 50% 0 0) }
.img-compare input[type=range]{ position:absolute; left:0; right:0; bottom:8px; width: 60%; margin: 0 auto; display:block }

/* Table/CSV compare */
.cmp-summary{ margin:6px 0; color:#374151; font-size:13px }
.cmp-table{ width:100%; border-collapse: collapse; font-size:12px }
.cmp-table th, .cmp-table td{ border-bottom:1px solid #eee; padding:4px 6px }
.cmp-row.add td{ background:#ecfdf5 }
.cmp-row.del td{ background:#fef2f2 }
.cmp-cell.diff{ background: linear-gradient(180deg,#fff7ed,#fffbeb) }

/* Sparkline */
.spark{ width:90px; height:18px; display:inline-block }
/* Screenshots gallery */
.gallery-wrap{ position: fixed; inset:0; display:none; grid-template-rows: auto 1fr; background: rgba(4,7,12,0.55); backdrop-filter: blur(6px) saturate(120%); z-index:99999 }
.gallery{ margin: 6vh auto; width:min(1000px, 94vw); background: linear-gradient(180deg,#ffffff,#f6f7f9); border:1px solid var(--color-line); border-radius:12px; box-shadow: 0 20px 60px rgba(0,0,0,0.25); display:grid; grid-template-rows:auto 1fr }
.gallery header{ padding:10px 12px; border-bottom:1px solid var(--color-line); display:flex; gap:8px; align-items:center }
.gallery main{ padding:12px; overflow:auto }
.grid-thumbs{ display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap:12px }
.thumb{ border:1px solid var(--color-line); border-radius:8px; padding:8px; background:linear-gradient(180deg,#ffffff,#fafafa) }
.thumb img{ width:100%; height:140px; object-fit:contain; display:block; background:#111 }
.thumb .row{ margin-top:6px }

/* Region capture overlay */
.region-wrap{ position: fixed; inset:0; z-index:99998; cursor: crosshair; display:none }
.region-dim{ position:absolute; inset:0; background: rgba(0,0,0,0.35); backdrop-filter: blur(1px); }
.region-rect{ position:absolute; border:2px solid var(--color-accent-teal); background: rgba(27,179,163,0.15); box-shadow: 0 0 0 1px rgba(0,0,0,0.2) inset }
.region-hint{ position:absolute; top:10px; left:50%; transform:translateX(-50%); color:#fff; background: rgba(0,0,0,0.6); padding:6px 10px; border-radius:8px; font-size:12px; z-index:1 }

/* Annotation overlay */
.annot-wrap{ position: fixed; inset:0; z-index:99998; display:none }
.annot-dim{ position:absolute; inset:0; background: rgba(0,0,0,0.55); backdrop-filter: blur(2px) }
.annot-panel{ position:absolute; top:6vh; left:50%; transform:translateX(-50%); width:min(96vw, 1100px); height:min(88vh, 820px); background: linear-gradient(180deg,#fff,#f7f7f9); border:1px solid var(--color-line); border-radius:12px; box-shadow: 0 20px 60px rgba(0,0,0,0.25); display:grid; grid-template-rows:auto 1fr auto }
.annot-panel header{ padding:10px 12px; border-bottom:1px solid var(--color-line); display:flex; gap:8px; align-items:center }
.annot-canvas{ position:relative; overflow:auto; background:#111 }
.annot-canvas img{ display:block; margin:0 auto; max-width:100%; max-height:100%; }
.ann-rect{ position:absolute; border:2px solid var(--color-accent-teal); background: rgba(27,179,163,0.12) }
.annot-panel footer{ padding:10px 12px; border-top:1px solid var(--color-line); display:flex; gap:8px; align-items:center; justify-content:flex-end }
.annot-toolbar{ margin-left:auto }
