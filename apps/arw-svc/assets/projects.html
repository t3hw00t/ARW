<!doctype html><meta charset="utf-8"><title>ARW Projects</title>
<style>
  :root{--line:#e5e7eb;--ink:#111827;--muted:#6b7280;--noise:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='2' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3CfeComponentTransfer%3E%3CfeFuncA type='table' tableValues='0 0.04'/%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E")}
  body{font-family:system-ui,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;margin:20px;color:var(--ink);background: radial-gradient(1000px 500px at 15% -10%, #ffffff, #f7f7f9 55%, #f1f5f9)}
  .grid{display:grid;grid-template-columns:260px 1fr;gap:16px}
  .box{border:1px solid var(--line);border-radius:12px;padding:12px;background:linear-gradient(180deg,#ffffff,#fafafa);box-shadow:0 12px 30px rgba(0,0,0,0.06), inset 0 1px 0 rgba(255,255,255,0.65);position:relative}
  .box::before{content:"";position:absolute;inset:0;background-image:var(--noise);opacity:.5;border-radius:12px;pointer-events:none}
  .row{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
  button,input{font:inherit;padding:8px 12px;border:1px solid var(--line);border-radius:8px;background-image:linear-gradient(180deg,#ffffff,#f3f4f6), var(--noise);background-blend-mode:overlay,normal;box-shadow:0 1px 0 rgba(255,255,255,0.9) inset, 0 8px 18px rgba(0,0,0,0.06)}
  ul{list-style:none;padding:0;margin:0}
  li{padding:4px 6px;cursor:pointer;border-radius:6px}
  li:hover{background:#f3f4f6}
  pre,textarea{background:linear-gradient(180deg,#ffffff,#fafafa);border:1px solid var(--line);border-radius:12px;padding:8px;overflow:auto;box-shadow:inset 0 1px 0 rgba(255,255,255,0.6)}
  textarea{width:100%;min-height:180px}
  @media (prefers-color-scheme: dark){
    body{ background: radial-gradient(1000px 500px at 15% -10%, #0f1117, #0b0d12 55%, #090b10); color:#e5e7eb }
    .box{ background: linear-gradient(180deg,#12161f,#0f141a); border-color:#1f232a; box-shadow: 0 12px 30px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.06) }
    .box::before{ opacity: .25 }
    button,input{ color:#e5e7eb; background-image:linear-gradient(180deg,#1a202b,#131822), var(--noise); border-color:#2a2f37; box-shadow: 0 1px 0 rgba(255,255,255,0.06) inset, 0 8px 18px rgba(0,0,0,0.35) }
    pre,textarea{ background: linear-gradient(180deg,#12161f,#0f141a); border-color:#1f232a; box-shadow: inset 0 1px 0 rgba(255,255,255,0.06) }
  }
</style>
<h1>Projects</h1>
<div class='grid'>
  <div class='box'>
    <div class='row'>
      <input id='projName' placeholder='project name' style='width: 160px;'>
      <button onclick='createProj()'>Create</button>
    </div>
    <ul id='projList'></ul>
  </div>
  <div class='box'>
    <div class='row'><span class='key'>project</span><code id='curProj'>â€“</code></div>
    <div class='row'>
      <div style='flex:1'>
        <h3>Notes</h3>
        <textarea id='notes' placeholder='Project notes...'></textarea>
        <div class='row'><button onclick='saveNotes()'>Save Notes</button> <button onclick='loadNotes()'>Reload</button></div>
      </div>
      <div style='flex:1'>
        <h3>Files</h3>
        <div id='tree' class='box' style='background:#fff; max-height:260px; overflow:auto'></div>
      </div>
    </div>
    <pre id='out'>{}</pre>
  </div>
</div>
<script>
const base=location.origin;
let current=null;
function setProj(n){ current=n; document.getElementById('curProj').textContent = n||'â€“'; if(n){ loadNotes(); loadTree(''); } }
async function listProjs(){ const r=await fetch(base+'/projects/list'); const j=await r.json().catch(()=>[]); const ul=document.getElementById('projList'); ul.innerHTML=''; (j.items||[]).forEach(n=>{ const li=document.createElement('li'); li.textContent=n; li.onclick=()=>setProj(n); ul.appendChild(li); }); }
async function createProj(){ const n=document.getElementById('projName').value.trim(); if(!n) return; await fetch(base+'/projects/create',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:n})}); await listProjs(); setProj(n); }
async function loadNotes(){ if(!current) return; const r=await fetch(base+'/projects/notes?proj='+encodeURIComponent(current)); const t=await r.text(); document.getElementById('notes').value=t; }
async function saveNotes(){ if(!current) return; const t=document.getElementById('notes').value||''; await fetch(base+'/projects/notes?proj='+encodeURIComponent(current),{method:'POST',headers:{'Content-Type':'text/plain'},body:t+'\n'}); show('saved'); }
function show(s){ document.getElementById('out').textContent=s; setTimeout(()=>{ document.getElementById('out').textContent='{}'; },1200); }
async function loadTree(p){ if(!current) return; const r=await fetch(base+'/projects/tree?proj='+encodeURIComponent(current)+'&path='+encodeURIComponent(p||'')); const j=await r.json().catch(()=>({items:[]})); const el=document.getElementById('tree'); el.innerHTML=''; (j.items||[]).forEach(it=>{ const d=document.createElement('div'); d.textContent = (it.dir?'ðŸ“ ':'ðŸ“„ ')+it.name; d.style.cursor='pointer'; d.onclick=()=>{ if(it.dir) loadTree(it.rel); }; el.appendChild(d); }); }
document.addEventListener('DOMContentLoaded', listProjs);
</script>
